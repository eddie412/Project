<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="memberMapper">

	<!-- 회원 가입 -->
	<insert id="register" >
		INSERT INTO
		TR_MEMBER(USERID,USERPASS,USERNAME,USEREMAIL,USERPHONE,USERADDR,USERBDAY)
		VALUES(#{userId},#{userPass},#{userName},#{userEmail},#{userPhone},#{userAddr},#{userBday})
	</insert>

	<!-- 로그인 -->
	<select id="login" resultType="com.tr.VO.MemberVO">
		Select USERID, USERPASS
		FROM		TR_MEMBER
		Where USERID = #{userId}
		AND USERPASS = #{userPass}
	</select>

	<!-- 패스워드 체크 -->
	<select id="passChk" resultType="int">
		SELECT COUNT(*)
		FROM TR_MEMBER
		WHERE USERID = #{userId}
		AND USERPASS = #{userPass}
	</select>

	<!-- 아이디 중복 체크 -->
	<select id="idChk" resultType="int">
		SELECT COUNT(*)
		FROM TR_MEMBER
		WHERE USERID = #{userId}
	</select>
	
	<!-- 마이페이지_회원정보 조회 -->
	<select id="info" resultType="com.tr.VO.MemberVO">
		SELECT 	*
		FROM		tr_member
		WHERE	userId = #{userId}
	</select>	
	
	<!-- 마이페이지_주문상세 -->
	<select id="order" resultType="com.tr.VO.OrderVO">
		SELECT oId, oNo, oDate, oNon, oName, oPrice, oCount, NVL(oTotal, oPrice*oCount) as oTotal
		FROM		tr_order
		WHERE oId = #{userId}
		ORDER BY oDate DESC
	</select>

	<!-- 마이페이지_문의사항 -->
	<select id="qna" resultType="com.tr.VO.QnaVO">
		SELECT		qTitle, qDate, qContent
		FROM			tr_qna
		WHERE		qWriter = #{userId}
		ORDER BY qDate DESC
	</select>

	<!-- 마이페이지_회원정보수정 -->
	<update id="update" >
		UPDATE 	tr_member
		SET 	userName = #{userName},
				userPass = #{userPass},
				userEmail = #{userEmail},
				userPhone = #{userPhone},
				userAddr = #{userAddr},
				userBday = #{userBday}
		WHERE userId = #{userId}
	</update>
	
	<!-- 마이페이지_회원정보삭제 -->
	<delete id="delete">
		DELETE FROM tr_member
		WHERE userId = #{userId}
		AND	  userPass = #{userPass}
	</delete>

</mapper>